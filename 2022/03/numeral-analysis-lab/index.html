<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="This article is migrated from Wordpress and may have lost the images in it.  Index Lab2 - Direct Methods for Solving Linear Equations Lab3 - Inverse Power Method to Solve Eigenvalue Lab4 - Jacobi Meth">
<meta property="og:type" content="article">
<meta property="og:title" content="Numerical Analysis - Lab">
<meta property="og:url" content="https://blog.depoze.xyz/2022/03/numeral-analysis-lab/index.html">
<meta property="og:site_name" content="CuSO4D&#39;s Electrolytic Cell">
<meta property="og:description" content="This article is migrated from Wordpress and may have lost the images in it.  Index Lab2 - Direct Methods for Solving Linear Equations Lab3 - Inverse Power Method to Solve Eigenvalue Lab4 - Jacobi Meth">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-03-28T13:54:40.000Z">
<meta property="article:modified_time" content="2022-03-28T13:54:40.000Z">
<meta property="article:author" content="CuSO4_Deposit">
<meta property="article:tag" content="C">
<meta property="article:tag" content="Math">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/depoze_512.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/depoze_512.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/depoze_512.png">
        
      
    
    <!-- title -->
    <title>Numerical Analysis - Lab</title>
    <!-- styles -->
	<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/lxgw-wenkai-webfont/1.6.0/style.min.css" />
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="CuSO4D&#39;s Electrolytic Cell" type="application/atom+xml" />
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
	<!-- typesetting -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js"></script>
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Articles</a></li><!--
     --><!--
       --><li><a href="/friends/">Friends</a></li><!--
     --><!--
       --><li><a href="/atom.xml">RSS</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2022/05/neat-examples-of-mathematica/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2022/03/poj-site-spider/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&text=Numerical Analysis - Lab"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&is_video=false&description=Numerical Analysis - Lab"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Numerical Analysis - Lab&body=Check out this article: https://blog.depoze.xyz/2022/03/numeral-analysis-lab/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&name=Numerical Analysis - Lab&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&t=Numerical Analysis - Lab"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Index"><span class="toc-number">1.</span> <span class="toc-text">Index</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab2-Direct-Methods-for-Solving-Linear-Equations"><span class="toc-number">2.</span> <span class="toc-text">Lab2 - Direct Methods for Solving Linear Equations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description"><span class="toc-number">2.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implement"><span class="toc-number">2.2.</span> <span class="toc-text">Implement</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Predefinition-and-Useful-functions"><span class="toc-number">2.2.1.</span> <span class="toc-text">Predefinition and Useful functions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Input"><span class="toc-number">2.2.2.</span> <span class="toc-text">Input</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solving-Triangular-Form-Equations"><span class="toc-number">2.2.3.</span> <span class="toc-text">Solving Triangular-Form Equations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Gaussian-Method"><span class="toc-number">2.2.4.</span> <span class="toc-text">Gaussian Method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LU-Decomposition-and-Doolittle-Method"><span class="toc-number">2.2.5.</span> <span class="toc-text">LU Decomposition and Doolittle Method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Calculate-Error"><span class="toc-number">2.2.6.</span> <span class="toc-text">Calculate Error</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Main-Function-Calling-the-Functions-implemented-above"><span class="toc-number">2.2.7.</span> <span class="toc-text">Main Function - Calling the Functions implemented above</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result"><span class="toc-number">2.3.</span> <span class="toc-text">Result</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-1"><span class="toc-number">2.3.1.</span> <span class="toc-text">Example 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">Example 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-number">2.4.</span> <span class="toc-text">Summary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab3-Inverse-Power-Method-to-Solve-Eigenvalue"><span class="toc-number">3.</span> <span class="toc-text">Lab3 - Inverse Power Method to Solve Eigenvalue</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-1"><span class="toc-number">3.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-number">3.2.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result-1"><span class="toc-number">3.3.</span> <span class="toc-text">Result</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-1-1"><span class="toc-number">3.3.1.</span> <span class="toc-text">Example 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-2-1"><span class="toc-number">3.3.2.</span> <span class="toc-text">Example 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analysis"><span class="toc-number">3.4.</span> <span class="toc-text">Analysis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab4-Jacobi-Method-to-Solve-Eigenvalue"><span class="toc-number">4.</span> <span class="toc-text">Lab4 - Jacobi Method to Solve Eigenvalue</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-2"><span class="toc-number">4.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-1"><span class="toc-number">4.2.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result-2"><span class="toc-number">4.3.</span> <span class="toc-text">Result</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-1-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">Example 1</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab-5-Cubic-Spline-Interpolation"><span class="toc-number">5.</span> <span class="toc-text">Lab 5 - Cubic Spline Interpolation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-3"><span class="toc-number">5.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-2"><span class="toc-number">5.2.</span> <span class="toc-text">Code</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Directory-Tree"><span class="toc-number">5.2.1.</span> <span class="toc-text">Directory Tree</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-code"><span class="toc-number">5.2.2.</span> <span class="toc-text">C code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python-code"><span class="toc-number">5.2.3.</span> <span class="toc-text">python code</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result-3"><span class="toc-number">5.3.</span> <span class="toc-text">Result</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab-6-FFT-amp-IFFT"><span class="toc-number">6.</span> <span class="toc-text">Lab 6 - FFT &amp; IFFT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-3"><span class="toc-number">6.1.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab7-Romberg-Integral"><span class="toc-number">7.</span> <span class="toc-text">Lab7 - Romberg Integral</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-4"><span class="toc-number">7.1.</span> <span class="toc-text">Code</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Numerical Analysis - Lab
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">CuSO4_Deposit</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-03-28T13:54:40.000Z" itemprop="datePublished">2022-03-28</time>
        
        (Updated: <time datetime="2022-03-28T13:54:40.000Z" itemprop="dateModified">2022-03-28</time>)
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/C/" rel="tag">C</a>, <a class="tag-link-link" href="/tags/Math/" rel="tag">Math</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>This article is migrated from Wordpress and may have lost the images in it. </p>
<h2 id="Index"><a href="#Index" class="headerlink" title="Index"></a>Index</h2><ul>
<li>Lab2 - Direct Methods for Solving Linear Equations</li>
<li>Lab3 - Inverse Power Method to Solve Eigenvalue</li>
<li>Lab4 - Jacobi Method to Solve Eigenvalue</li>
<li>Lab 5 - Cubic Spline Interpolation</li>
<li>Lab 6 - FFT &amp; IFFT]</li>
<li>Lab 7 - Romberg Integral</li>
</ul>
<h2 id="Lab2-Direct-Methods-for-Solving-Linear-Equations"><a href="#Lab2-Direct-Methods-for-Solving-Linear-Equations" class="headerlink" title="Lab2 - Direct Methods for Solving Linear Equations"></a>Lab2 - Direct Methods for Solving Linear Equations</h2><h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>Use C&#x2F;C++, implement the following algorithms:</p>
<ol>
<li>Gaussian Elimination</li>
<li>Doolittle Decomposition</li>
</ol>
<h3 id="Implement"><a href="#Implement" class="headerlink" title="Implement"></a>Implement</h3><h4 id="Predefinition-and-Useful-functions"><a href="#Predefinition-and-Useful-functions" class="headerlink" title="Predefinition and Useful functions"></a>Predefinition and Useful functions</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SUCCESS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAILURE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INPUTPATH <span class="string">&quot;./InputData.txt&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Status;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span>* Vector;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span>** Matrix;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PrintMatrix</span><span class="params">(<span class="type">int</span> n, Matrix A)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PrintMatrix</span></span><br><span class="line"><span class="comment">     *  Description:  Print the Matrix A to the terminal. n is the Dimension of A. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\t&quot;</span>, A[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PrintVector</span><span class="params">(<span class="type">int</span> n, Vector v)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PrintVector</span></span><br><span class="line"><span class="comment">     *  Description:  Print the Vector v to the terminal(in row form). n is the Dimension of v. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\t&quot;</span>, v[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h4><p>Using a file to input is the most stable way. Two key functions here: <a target="_blank" rel="noopener" href="https://www.cplusplus.com/reference/string/string/getline/"><em>getline</em></a> and <a target="_blank" rel="noopener" href="http://www.cplusplus.com/reference/cstdlib/strtod/"><em>strtod</em></a>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Status <span class="title">ReadFromInput</span><span class="params">(<span class="type">int</span>&amp; n, Matrix&amp; A, Vector&amp; b, <span class="type">bool</span> PrintResult)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  ReadFromInput</span></span><br><span class="line"><span class="comment">     *  Description:  Read data from input file. File Format:</span></span><br><span class="line"><span class="comment">     *                  The first line indicates n.</span></span><br><span class="line"><span class="comment">     *                  The next n line is the Matrix A, separated by space.</span></span><br><span class="line"><span class="comment">     *                  The last line is the vector b, separated by space.</span></span><br><span class="line"><span class="comment">     *                  </span></span><br><span class="line"><span class="comment">     *                  It&#x27;s recommended that the number are written in demical.</span></span><br><span class="line"><span class="comment">     *                      e.g.  Use &quot;1.0&quot;, not &quot;1&quot;.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ifstream inputfile;</span><br><span class="line">    inputfile.<span class="built_in">open</span>(INPUTPATH);</span><br><span class="line">    string str;</span><br><span class="line">    <span class="type">char</span>* endptr;</span><br><span class="line">    <span class="keyword">if</span>(inputfile.<span class="built_in">is_open</span>())&#123;</span><br><span class="line">        <span class="built_in">getline</span>(inputfile, str);    <span class="comment">//Reading n.</span></span><br><span class="line">        n = <span class="built_in">stoi</span>(str);</span><br><span class="line"></span><br><span class="line">        A = <span class="keyword">new</span> Vector[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            A[i] = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">        &#125;</span><br><span class="line">        b = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123; <span class="comment">// Reading A.</span></span><br><span class="line">            <span class="built_in">getline</span>(inputfile, str);</span><br><span class="line">            <span class="type">char</span> SameAsStr[str.<span class="built_in">length</span>() + <span class="number">1</span>];   <span class="comment">//* Convert str to char* type for </span></span><br><span class="line">            <span class="built_in">strcpy</span>(SameAsStr, str.<span class="built_in">c_str</span>());     <span class="comment">//*   the strtod function.</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">                A[i][j] = <span class="built_in">strtod</span>(SameAsStr, &amp;endptr);</span><br><span class="line">                <span class="built_in">strcpy</span>(SameAsStr, endptr);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">getline</span>(inputfile, str);    <span class="comment">// Reading b.</span></span><br><span class="line">        <span class="type">char</span> SameAsStr[str.<span class="built_in">length</span>() + <span class="number">1</span>];   <span class="comment">//* Convert str to char* type for </span></span><br><span class="line">        <span class="built_in">strcpy</span>(SameAsStr, str.<span class="built_in">c_str</span>());     <span class="comment">//*  the strtod function.</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">            b[j] = <span class="built_in">strtod</span>(SameAsStr, &amp;endptr);</span><br><span class="line">            <span class="built_in">strcpy</span>(SameAsStr, endptr);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        inputfile.<span class="built_in">close</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(PrintResult)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Matrix A:\n&quot;</span>);</span><br><span class="line">            <span class="built_in">PrintMatrix</span>(n, A);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Vector b:\n&quot;</span>);</span><br><span class="line">            <span class="built_in">PrintVector</span>(n, b);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Input Error, please check.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Solving-Triangular-Form-Equations"><a href="#Solving-Triangular-Form-Equations" class="headerlink" title="Solving Triangular-Form Equations"></a>Solving Triangular-Form Equations</h4><p>LTM Solve Algorithm and UTM Solve Algorithm is symmetric. So we just call <em>UpperSolve</em> function when implementing <em>LowerSolve</em>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Status <span class="title">UpperSolve</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector b, Vector x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  UpperSolve</span></span><br><span class="line"><span class="comment">     *  Description:  When A is an Upper Triangular Matrix, use elimination, solve Ax == b. </span></span><br><span class="line"><span class="comment">     *    Parameter:  n is D[A]. x is the solution.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">abs</span>(A[i][j]) &gt; <span class="number">0.000001</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;This Matrix is not a Upper Triangular Matrix.\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> FAILURE;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n - <span class="number">1</span>; i &gt; <span class="number">-1</span>; i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(A[i][i] == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;This entry have infinity solutions.\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> FAILURE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">double</span> InPathe = b[i]; </span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = n - <span class="number">1</span>; j &gt; i; j--)&#123;</span><br><span class="line">            InPathe -= A[i][j] * x[j];</span><br><span class="line">        &#125;</span><br><span class="line">        x[i] = InPathe / A[i][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">LowerSolve</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector b, Vector x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  LowerSolve</span></span><br><span class="line"><span class="comment">     *  Description:   When A is an Lower Triangular Matrix, use elimination, solve Ax == b. </span></span><br><span class="line"><span class="comment">     *    Parameter:  n is D[A]. x is the solution.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">        Matrix TempA = <span class="keyword">new</span> Vector[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            TempA[i] = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">        &#125;</span><br><span class="line">        Vector Tempb = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">        Vector Tempx = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            Tempb[i] = b[n - <span class="number">1</span> - i];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                TempA[i][j] = A[n - <span class="number">1</span> - i][n - <span class="number">1</span> - j];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">UpperSolve</span>(n, TempA, Tempb, Tempx))&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;This Matrix is not a Lower Triangular Matrix.\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> FAILURE;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            x[i] = Tempx[n - <span class="number">1</span> - i];</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Gaussian-Method"><a href="#Gaussian-Method" class="headerlink" title="Gaussian Method"></a>Gaussian Method</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Status <span class="title">ChoosePivot</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector b, <span class="type">int</span> ProcessingColumn)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  ChoosePivot</span></span><br><span class="line"><span class="comment">     *  Description:  Choose the Pivot of Processing Column, do the exchange. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">double</span> MaxAbs = <span class="built_in">abs</span>(A[ProcessingColumn][ProcessingColumn]);</span><br><span class="line">    <span class="type">int</span> MaxAbsRow = ProcessingColumn;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = ProcessingColumn + <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(A[i][ProcessingColumn]) &gt; MaxAbs)&#123;</span><br><span class="line">            MaxAbs = <span class="built_in">abs</span>(A[i][ProcessingColumn]);</span><br><span class="line">            MaxAbsRow = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">double</span> temp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">        temp = A[ProcessingColumn][j]; A[ProcessingColumn][j] = A[MaxAbsRow][j]; A[MaxAbsRow][j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    temp = b[ProcessingColumn]; b[ProcessingColumn] = b[MaxAbsRow]; b[MaxAbsRow] = temp;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">GaussMethod</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector b, Vector x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  GaussMethod</span></span><br><span class="line"><span class="comment">     *  Description:   </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++)&#123;</span><br><span class="line">        <span class="built_in">ChoosePivot</span>(n, A, b, k);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ==== set the condition to non-zero to display eliminating process. ==========</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>)&#123; </span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ChoosePivot #%d\n&quot;</span>, k);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Matrix A:\n&quot;</span>);</span><br><span class="line">            <span class="built_in">PrintMatrix</span>(n, A);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Vector b:\n&quot;</span>);</span><br><span class="line">            <span class="built_in">PrintVector</span>(n, b);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">// ================================================================================</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(A[k][k]) &lt; <span class="number">0.0000000001</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;This pivot can&#x27;t be den.\n&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> FAILURE;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = k + <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="type">double</span> Coefficient = A[i][k] / A[k][k];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = k; j &lt; n; j++)</span><br><span class="line">                A[i][j] -= Coefficient * A[k][j];</span><br><span class="line">            b[i] -= Coefficient * b[k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Matrix After Elimination:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintMatrix</span>(n, A);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Vector After Elimination:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintVector</span>(n, b);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UpperSolve</span>(n, A, b, x);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The solution is:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintVector</span>(n, x);</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="LU-Decomposition-and-Doolittle-Method"><a href="#LU-Decomposition-and-Doolittle-Method" class="headerlink" title="LU Decomposition and Doolittle Method"></a>LU Decomposition and Doolittle Method</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Status <span class="title">LUDecomposition</span><span class="params">(<span class="type">int</span> n, Matrix A, Matrix L, Matrix U)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  LUDecomposition</span></span><br><span class="line"><span class="comment">     *  Description:  Do Doolittle decompose: A = LU, return via param L and U. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i + <span class="number">1</span>; j++)&#123;</span><br><span class="line">            L[i][j] = A[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">            L[i][j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">            U[i][j] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i; j&lt; n; j++)</span><br><span class="line">            U[i][j] = A[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = k; j &lt; n; j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> r = <span class="number">0</span>; r &lt; k; r++)</span><br><span class="line">                U[k][j] -= L[k][r] * U[r][j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = k; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> r = <span class="number">0</span>; r &lt; k; r++)</span><br><span class="line">                L[i][k] -= L[i][r] * U[r][k];</span><br><span class="line">            <span class="keyword">if</span>(U[k][k] == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Divided by 0.\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> FAILURE;</span><br><span class="line">            &#125;    </span><br><span class="line">            L[i][k] /= U[k][k];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">DoolittleMethod</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector b, Vector x)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  DoolittleMethod</span></span><br><span class="line"><span class="comment">     *  Description:  Using DoolittleMethod to Solve Ax == b,</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Matrix L = <span class="keyword">new</span> Vector[n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        L[i] = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    &#125;</span><br><span class="line">    Matrix U = <span class="keyword">new</span> Vector[n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        U[i] = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    &#125;</span><br><span class="line">    Vector y = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">LUDecomposition</span>(n, A, L, U);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;L:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintMatrix</span>(n, L);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;U:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintMatrix</span>(n, U);</span><br><span class="line">    <span class="built_in">LowerSolve</span>(n, L, b, y);</span><br><span class="line">    <span class="built_in">UpperSolve</span>(n, U, y, x);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintVector</span>(n, x);</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Calculate-Error"><a href="#Calculate-Error" class="headerlink" title="Calculate Error"></a>Calculate Error</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Status <span class="title">CalculateError</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector x, Vector b)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  CalculateError</span></span><br><span class="line"><span class="comment">     *  Description:  Using 2-Norm to Calculate Norm(Ax - b). </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Vector t = <span class="keyword">new</span> <span class="type">double</span>[n];   <span class="comment">//t = Ax - b.</span></span><br><span class="line">    <span class="type">double</span> Sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n; k++)&#123;</span><br><span class="line">        t[k] = -b[k];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">            t[k] += A[k][j] * x[j];</span><br><span class="line">        Sum += t[k] * t[k];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">double</span> Error = <span class="built_in">sqrt</span>(Sum);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;The Error Vector is:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintVector</span>(n, t);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Error = %.12lf\n&quot;</span>, Error);</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Main-Function-Calling-the-Functions-implemented-above"><a href="#Main-Function-Calling-the-Functions-implemented-above" class="headerlink" title="Main Function - Calling the Functions implemented above"></a>Main Function - Calling the Functions implemented above</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Matrix A = <span class="literal">NULL</span>;</span><br><span class="line">    Vector b = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ReadFromInput</span>(n, A, b, <span class="number">1</span>);</span><br><span class="line">    Vector x = <span class="literal">NULL</span>;</span><br><span class="line">    x = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    <span class="keyword">switch</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">GaussMethod</span>(n, A, b, x);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="built_in">DoolittleMethod</span>(n, A, b, x);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Invalid Argument.\n&quot;</span>);</span><br><span class="line">            <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">ReadFromInput</span>(n, A, b, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">CalculateError</span>(n, A, x, b);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h3><h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example 1"></a>Example 1</h4><p>Using Gaussian Method:</p>
<p>$ g++ DecompositionMethod.cpp -o De.out<br>$ .&#x2F;De.out<br>Matrix A:<br>0.11110.12500.14290.16670.2000<br>0.12500.14290.16670.20000.2500<br>0.14290.16670.20000.25000.3333<br>0.16670.20000.25000.33330.5000<br>0.20000.25000.33330.50001.0000<br>Vector b:<br>1.00001.00001.00001.00001.0000</p>
<p>Matrix After Elimination:<br>0.20000.25000.33330.50001.0000<br>0.0000-0.0139-0.0423-0.1111-0.3556<br>0.00000.0000-0.0024-0.0167-0.1200<br>0.00000.0000-0.00000.00080.0152<br>0.00000.00000.00000.0000-0.0007<br>Vector After Elimination:<br>1.00000.4444-0.1000-0.0190-0.0036<br>The solution is:<br>629.9978 -1119.9957 629.9972 -119.9994 5.0000</p>
<p>The Error Vector is:<br>-0.0000-0.00000.0000-0.0000-0.0000<br>Error &#x3D; 0.000000000000</p>
<p>Using Doolittle Method:</p>
<p>$ g++ DecompositionMethod.cpp -o De.out<br>$ .&#x2F;De.out<br>Matrix A:<br>0.11110.12500.14290.16670.2000<br>0.12500.14290.16670.20000.2500<br>0.14290.16670.20000.25000.3333<br>0.16670.20000.25000.33330.5000<br>0.20000.25000.33330.50001.0000<br>Vector b:<br>1.00001.00001.00001.00001.0000</p>
<p>L:<br>1.00000.00000.00000.00000.0000<br>1.12501.00000.00000.00000.0000<br>1.28572.66671.00000.00000.0000<br>1.50005.60005.25001.00000.0000<br>1.800011.200021.000012.00001.0000<br>U:<br>0.11110.12500.14290.16670.2000<br>0.00000.00220.00600.01250.0250<br>0.00000.00000.00050.00240.0095<br>0.00000.00000.00000.00080.0100<br>0.00000.00000.00000.00000.0400<br>x:<br>629.9978 -1119.9957 629.9972 -119.9994 5.0000<br>The Error Vector is:<br>-0.00000.0000-0.0000-0.00000.0000<br>Error &#x3D; 0.000000000000</p>
<p>We don’t have much error here…thanks to the double precision floating point type.</p>
<h4 id="Example-2"><a href="#Example-2" class="headerlink" title="Example 2"></a>Example 2</h4><p>Using Gaussian Method:</p>
<p>$ g++ DecompositionMethod.cpp -o De.out<br>$ .&#x2F;De.out<br>Matrix A:<br>7.20002.3000-4.40000.5000<br>1.30006.3000-3.50002.8000<br>5.60000.90008.1000-1.3000<br>1.50000.40003.70005.9000<br>Vector b:<br>15.10001.800016.600036.9000</p>
<p>Matrix After Elimination:<br>7.20002.3000-4.40000.5000<br>0.00005.8847-2.70562.7097<br>0.00000.000011.1135-1.2796<br>0.00000.00000.00006.3596<br>Vector After Elimination:<br>15.1000-0.92644.715631.7982<br>The solution is:<br>3.0000-2.00001.00005.0000<br>The Error Vector is:<br>-0.0000-0.0000-0.00000.0000<br>Error &#x3D; 0.000000000000</p>
<p>Using Doolittle Method:</p>
<p>$ g++ DecompositionMethod.cpp -o De.out<br>$ .&#x2F;De.out<br>Matrix A:<br>7.20002.3000-4.40000.5000<br>1.30006.3000-3.50002.8000<br>5.60000.90008.1000-1.3000<br>1.50000.40003.70005.9000<br>Vector b:<br>15.10001.800016.600036.9000</p>
<p>L:<br>1.00000.00000.00000.0000<br>0.18061.00000.00000.0000<br>0.7778-0.15111.00000.0000<br>0.2083-0.01350.41211.0000<br>U:<br>7.20002.3000-4.40000.5000<br>0.00005.8847-2.70562.7097<br>0.00000.000011.1135-1.2796<br>0.00000.00000.00006.3596<br>x:<br>3.0000-2.00001.00005.0000<br>The Error Vector is:<br>-0.0000-0.0000-0.00000.0000<br>Error &#x3D; 0.000000000000</p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>For the 1st example, when the true input are fractions, we still have some larger error because I use an file to input, and introduced function <em>strtod</em>. So I don’t even have a way to represent fractions as accurate as a double type - What I can do is just input more digits, as an approximate value.</p>
<p>Finally, in these two examples, our error is eliminated below $10^{-12}$. We can say our programs works well.</p>
<h2 id="Lab3-Inverse-Power-Method-to-Solve-Eigenvalue"><a href="#Lab3-Inverse-Power-Method-to-Solve-Eigenvalue" class="headerlink" title="Lab3 - Inverse Power Method to Solve Eigenvalue"></a>Lab3 - Inverse Power Method to Solve Eigenvalue</h2><h3 id="Description-1"><a href="#Description-1" class="headerlink" title="Description"></a>Description</h3><p>Solve the minimal eigenvalue and its eigenvector of a given matrix.</p>
<h3 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h3><p>Note: Lab3 referenced the code through “<em>Lab2.h</em>“</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       Filename:  Inverse-Power-Method.cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    Description: Use inverse power method to calculate the minimal eigenvalue.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *        Version:  1.0</span></span><br><span class="line"><span class="comment"> *        Created:  04/08/2022 02:35:07 UTC</span></span><br><span class="line"><span class="comment"> *       Revision:  none</span></span><br><span class="line"><span class="comment"> *       Compiler:  gcc</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *         Author:  CuSO4_Deposit</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;../Lab2/Lab2.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SUCCESS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAILURE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INPUTPATH <span class="string">&quot;./InputData.txt&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Status;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span>* Vector;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span>** Matrix;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">Matrix_Multiplication</span><span class="params">(<span class="type">int</span> A_m, <span class="type">int</span> A_n, <span class="type">int</span> B_m, <span class="type">int</span> B_n, Matrix A, Matrix B, Matrix Result)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  Matrix_Multiplication</span></span><br><span class="line"><span class="comment">     *  Description:  Calculate the multiplication of A and B. A has m rows and n cols. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span>(A_n != B_m)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;A and B can&#x27;t multiply.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; A_m; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; B_n; j++)&#123;</span><br><span class="line">            Result[i][j] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; A_n; k++)</span><br><span class="line">                Result[i][j] += A[i][k] * B[k][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">IPM_Iteration</span><span class="params">(<span class="type">int</span> n, Matrix A, <span class="type">double</span>&amp; eigenvalue, Vector eigenvector)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  IPM_Iteration</span></span><br><span class="line"><span class="comment">     *  Description:  Do the iteration of inverse power method to A. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Vector x = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    <span class="comment">//double value = sqrt(double(1) / n); </span></span><br><span class="line">    <span class="type">double</span> value = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        x[i] = <span class="number">1</span>;</span><br><span class="line">    Vector x_prior = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        x_prior[i] = value;</span><br><span class="line">    Vector temp = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        temp[i] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    Matrix L = <span class="keyword">new</span> Vector[n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        L[i] = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    Matrix U = <span class="keyword">new</span> Vector[n];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        U[i] = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    <span class="built_in">LUDecomposition</span>(n, A, L, U);</span><br><span class="line">    <span class="type">double</span> error = <span class="number">10</span>;</span><br><span class="line">    <span class="type">double</span> Max_prior = value;</span><br><span class="line">    <span class="type">double</span> Max = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x_idx = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> x_prior_idx = <span class="number">0</span>;</span><br><span class="line">    <span class="type">bool</span> indexFlag = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> eigenvalue_prior;</span><br><span class="line">    <span class="type">int</span> iter_counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(error &gt; <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">-5</span>)  indexFlag == <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Iteration #%d:\n&quot;</span>, ++iter_counter);</span><br><span class="line">        <span class="built_in">LowerSolve</span>(n, L, x_prior, temp); <span class="comment">// Now temp is the temp vector to solve equation.</span></span><br><span class="line">        <span class="built_in">UpperSolve</span>(n, U, temp, x);       <span class="comment">//</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;x[%d] =\n&quot;</span>, iter_counter);</span><br><span class="line">        <span class="built_in">PrintVector</span>(n, x);</span><br><span class="line">        Max = x[<span class="number">0</span>]; x_idx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)  <span class="comment">// Find max entry in x(not normalized)</span></span><br><span class="line">            <span class="keyword">if</span>(x[i] &gt; Max)&#123;</span><br><span class="line">                Max = x[i];</span><br><span class="line">                x_idx = i;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="comment">//error = abs(Max - Max_prior);</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Error = %lf.\n&quot;</span>, error);</span><br><span class="line">        <span class="keyword">if</span>(x_idx == x_prior_idx)</span><br><span class="line">            indexFlag = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span>    indexFlag = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)              <span class="comment">//* Update data (x -&gt; x_prior)</span></span><br><span class="line">            x_prior[i] = x[i] / Max;            <span class="comment">//*</span></span><br><span class="line">        Max_prior = Max; x_prior_idx = x_idx;   <span class="comment">//*</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Y[%d] =\n&quot;</span>, iter_counter);<span class="comment">//*</span></span><br><span class="line">        <span class="built_in">PrintVector</span>(n, x_prior);</span><br><span class="line"></span><br><span class="line">        eigenvalue_prior = eigenvalue;</span><br><span class="line">        eigenvalue = <span class="number">1</span> / x[x_idx];</span><br><span class="line">        error = <span class="built_in">abs</span>(eigenvalue - eigenvalue_prior);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Estimated EV = %lf\n&quot;</span>, eigenvalue);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        eigenvector[i] = x_prior[i];</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Matrix A = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ReadFromInput</span>(n, A, <span class="number">1</span>);</span><br><span class="line">    <span class="type">double</span> EValue;</span><br><span class="line">    Vector EVector = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    <span class="built_in">IPM_Iteration</span>(n, A, EValue, EVector);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;EigenValue = %lf\n&quot;</span>, EValue);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;EigenVector:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintVector</span>(n, EVector);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Result-1"><a href="#Result-1" class="headerlink" title="Result"></a>Result</h3><h4 id="Example-1-1"><a href="#Example-1-1" class="headerlink" title="Example 1"></a>Example 1</h4><p>Raw Output:</p>
<p>$ .&#x2F;Inverse-Power-Method.out<br>Matrix A:<br>0.11110.12500.14290.16670.2000<br>0.12500.14290.16670.20000.2500<br>0.14290.16670.20000.25000.3333<br>0.16670.20000.25000.33330.5000<br>0.20000.25000.33330.50001.0000</p>
<p>Iteration #1:<br>x[1] &#x3D;<br>629.9978-1119.9957629.9972-119.99945.0000<br>Error &#x3D; 10.000000.<br>Y[1] &#x3D;<br>1.0000-1.77781.0000-0.19050.0079<br>Estimated EV &#x3D; 0.001587</p>
<p>Iteration #2:<br>x[2] &#x3D;<br>260004.0147-529506.9293348753.7531-80203.06204226.2173<br>Error &#x3D; 0.001587.<br>Y[2] &#x3D;<br>0.7455-1.51831.0000-0.23000.0121<br>Estimated EV &#x3D; 0.000003</p>
<p>Iteration #3:<br>x[3] &#x3D;<br>226394.6541-461628.5632304559.4849-70212.33383714.5607<br>Error &#x3D; 0.001584.<br>Y[3] &#x3D;<br>0.7434-1.51571.0000-0.23050.0122<br>Estimated EV &#x3D; 0.000003<br>EigenValue &#x3D; 0.000003<br>EigenVector:<br>0.7434-1.51571.0000-0.23050.0122</p>
<p>Iteration # i</p>
<p>$X^{(i)}$</p>
<p>$Y^{(i)}$</p>
<p>$\lambda$</p>
<p>1</p>
<p>629.9978 -1119.9957 629.9972 -119.9994 5.0000</p>
<p>1.0000 -1.7778 1.0000 -0.1905 0.0079</p>
<p>0.001587</p>
<p>2</p>
<p>260004.0147 -529506.9293 348753.7531 -80203.0620 4226.2173</p>
<p>0.7455 -1.5183 1.0000 -0.2300 0.0121</p>
<p>0.000003</p>
<p>3</p>
<p>226394.6541 -461628.5632 304559.4849 -70212.3338 3714.5607</p>
<p>0.7434 -1.5157 1.0000 -0.2305 0.0122</p>
<p>0.000003</p>
<p>Iteration Process</p>
<h4 id="Example-2-1"><a href="#Example-2-1" class="headerlink" title="Example 2"></a>Example 2</h4><p>Raw Output:</p>
<p>$ .&#x2F;Inverse-Power-Method.out<br>Matrix A:<br>4.0000-1.00001.00003.0000<br>16.0000-2.0000-2.00005.0000<br>16.0000-3.0000-1.00007.0000<br>6.0000-4.00002.00009.0000</p>
<p>Iteration #1:<br>x[1] &#x3D;<br>0.00002.0000-0.00001.0000<br>Error &#x3D; 10.000000.<br>Y[1] &#x3D;<br>0.00001.0000-0.00000.5000<br>Estimated EV &#x3D; 0.500000</p>
<p>Iteration #2:<br>x[2] &#x3D;<br>-0.62505.6250-2.37503.5000<br>Error &#x3D; 0.500000.<br>Y[2] &#x3D;<br>-0.11111.0000-0.42220.6222<br>Estimated EV &#x3D; 0.177778</p>
<p>Iteration #3:<br>x[3] &#x3D;<br>-0.93338.0778-3.43335.0444<br>Error &#x3D; 0.322222.<br>Y[3] &#x3D;<br>-0.11551.0000-0.42500.6245<br>Estimated EV &#x3D; 0.123796</p>
<p>Iteration #4:<br>x[4] &#x3D;<br>-0.93628.0899-3.44385.0543<br>Error &#x3D; 0.053981.<br>Y[4] &#x3D;<br>-0.11571.0000-0.42570.6248<br>Estimated EV &#x3D; 0.123611</p>
<p>Iteration #5:<br>x[5] &#x3D;<br>-0.93678.0938-3.44555.0568<br>Error &#x3D; 0.000186.<br>Y[5] &#x3D;<br>-0.11571.0000-0.42570.6248<br>Estimated EV &#x3D; 0.123551</p>
<p>Iteration #6:<br>x[6] &#x3D;<br>-0.93678.0939-3.44555.0568<br>Error &#x3D; 0.000059.<br>Y[6] &#x3D;<br>-0.11571.0000-0.42570.6248<br>Estimated EV &#x3D; 0.123551<br>EigenValue &#x3D; 0.123551<br>EigenVector:<br>-0.11571.0000-0.42570.6248</p>
<p>Iteration # i</p>
<p>X^{(i)}</p>
<p>Y^{(i)}</p>
<p>$\lambda$</p>
<p>1</p>
<p>0.0000 2.0000 -0.0000 1.0000</p>
<p>0.0000 1.0000 -0.0000 0.5000</p>
<p>0.500000</p>
<p>2</p>
<p>-0.6250 5.6250 -2.3750 3.5000</p>
<p>-0.1111 1.0000 -0.4222 0.6222</p>
<p>0.177778</p>
<p>3</p>
<p>-0.9333 8.0778 -3.4333 5.0444</p>
<p>-0.1155 1.0000 -0.4250 0.6245</p>
<p>0.123796</p>
<p>4</p>
<p>-0.9362 8.0899 -3.4438 5.0543</p>
<p>-0.1157 1.0000 -0.4257 0.6248</p>
<p>0.123611</p>
<p>5</p>
<p>-0.9367 8.0938 -3.4455 5.0568</p>
<p>-0.1157 1.0000 -0.4257 0.6248</p>
<p>0.123551</p>
<p>6</p>
<p>-0.9367 8.0939 -3.4455 5.0568</p>
<p>-0.1157 1.0000 -0.4257 0.6248</p>
<p>0.123551</p>
<p>Iteration Process</p>
<h3 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h3><p>The smaller the minimal eigenvalue is, the faster the iteration converges. In example 1(iterated 3 times), eigenvalue is 0.000003, much smaller than 0.123 in ex2(iterated 6 times).</p>
<h2 id="Lab4-Jacobi-Method-to-Solve-Eigenvalue"><a href="#Lab4-Jacobi-Method-to-Solve-Eigenvalue" class="headerlink" title="Lab4 - Jacobi Method to Solve Eigenvalue"></a>Lab4 - Jacobi Method to Solve Eigenvalue</h2><h3 id="Description-2"><a href="#Description-2" class="headerlink" title="Description"></a>Description</h3><p>Solve all eigenvalues of a given matrix, using Jacobi method.</p>
<h3 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h3><p>Note: Lab4 referenced the code through “<em>Lab2.h</em>“, it’s code is <a href="#Lab2">here</a>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       Filename:  JacobiMethod.cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    Description:  Solve n Eigenvalues of a given matrix.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *        Version:  1.0</span></span><br><span class="line"><span class="comment"> *        Created:  04/25/2022 14:41:30 UTC</span></span><br><span class="line"><span class="comment"> *       Revision:  none</span></span><br><span class="line"><span class="comment"> *       Compiler:  gcc</span></span><br><span class="line"><span class="comment"> *         Author:  CuSO4_Deposit</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;..\Lab2\Lab2.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SUCCESS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAILURE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INPUTPATH <span class="string">&quot;./InputData.txt&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">GenerateRandomMatrix</span><span class="params">(<span class="type">int</span> n, Matrix A)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  GenerateRandomMatrix</span></span><br><span class="line"><span class="comment">     *  Description:  Generate a random symmetry matrix, where each entry ranges from 0 to 1.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i; j &lt; n; j++)&#123;</span><br><span class="line">            A[i][j] = <span class="built_in">rand</span>()%<span class="number">10001</span> / <span class="number">10000.0</span>;</span><br><span class="line">            A[j][i] = A[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">CheckSymmetry</span><span class="params">(<span class="type">int</span> n, Matrix A)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  CheckSymmetry</span></span><br><span class="line"><span class="comment">     *  Description:  if A is symmetry, return 1, otherwise return 0.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(A[i][j] != A[j][i])</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">NonDiagSquareSum</span><span class="params">(<span class="type">int</span> n, Matrix A)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  NonDiagSum</span></span><br><span class="line"><span class="comment">     *  Description:  return the sum of non-diagonal entries&#x27; square of A. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">double</span> Sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i + <span class="number">1</span>; j &lt; n; j++)</span><br><span class="line">            Sum += A[i][j] * A[i][j];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * Sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">JacobiMethod</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector EigenvalueVector, <span class="type">double</span> ErrorController)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  JacobiMethod</span></span><br><span class="line"><span class="comment">     *  Description:  Output the n eigenvalues via &lt;EigenvalueVector&gt;</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">CheckSymmetry</span>(n, A))&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;The input matrix is not symmetry.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> FAILURE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> MaxEntry_i = <span class="number">0</span>; <span class="type">int</span> MaxEntry_j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> MaxEntry = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> LoopCounter = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> s = <span class="number">0</span>; <span class="type">double</span> t = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> t1 = <span class="number">0</span>; <span class="type">double</span> t2 = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> c = <span class="number">0</span>; <span class="type">double</span> d = <span class="number">0</span>;</span><br><span class="line">    <span class="type">double</span> api = <span class="number">0</span>; <span class="type">double</span> aqi = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">NonDiagSquareSum</span>(n, A) &gt; ErrorController)&#123;</span><br><span class="line">        MaxEntry = <span class="built_in">abs</span>(A[<span class="number">0</span>][<span class="number">1</span>]); MaxEntry_i = <span class="number">0</span>; MaxEntry_j = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(j == i)  <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">abs</span>(A[i][j]) &gt; MaxEntry)&#123;</span><br><span class="line">                    MaxEntry_i = i;</span><br><span class="line">                    MaxEntry_j = j;</span><br><span class="line">                    MaxEntry = <span class="built_in">abs</span>(A[i][j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        s = (A[MaxEntry_j][MaxEntry_j] - A[MaxEntry_i][MaxEntry_i]) / (<span class="number">2</span> * A[MaxEntry_i][MaxEntry_j]);</span><br><span class="line"></span><br><span class="line">        t1 = -s - <span class="built_in">sqrt</span>(s * s + <span class="number">1</span>);  t2 = -t1 - <span class="number">2</span> * s;</span><br><span class="line">        t = <span class="built_in">abs</span>(t1) &gt; <span class="built_in">abs</span>(t2) ? t2 : t1;</span><br><span class="line">        <span class="keyword">if</span>(s == <span class="number">0</span>)  t = <span class="number">1</span>;</span><br><span class="line">        c = <span class="number">1</span> / <span class="built_in">sqrt</span>(<span class="number">1</span> + t * t); d = t * c;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i == MaxEntry_i  i == MaxEntry_j)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            api = A[i][MaxEntry_i]; aqi = A[i][MaxEntry_j];</span><br><span class="line">            A[i][MaxEntry_i] = c * api - d * aqi; </span><br><span class="line">            A[MaxEntry_i][i] = A[i][MaxEntry_i];</span><br><span class="line">            A[i][MaxEntry_j] = c * aqi + d * api;</span><br><span class="line">            A[MaxEntry_j][i] = A[i][MaxEntry_j];</span><br><span class="line">        &#125;</span><br><span class="line">        A[MaxEntry_i][MaxEntry_i] -= t * A[MaxEntry_i][MaxEntry_j];</span><br><span class="line">        A[MaxEntry_j][MaxEntry_j] += t * A[MaxEntry_i][MaxEntry_j];</span><br><span class="line">        A[MaxEntry_i][MaxEntry_j] = <span class="number">0</span>;</span><br><span class="line">        A[MaxEntry_j][MaxEntry_i] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Iteration #%d\n&quot;</span>, ++LoopCounter);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Non-Diagonal Entries&#x27; Square Sum = %lf.\n&quot;</span>, <span class="built_in">NonDiagSquareSum</span>(n, A));</span><br><span class="line">        <span class="built_in">PrintMatrix</span>(n, A);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        EigenvalueVector[i] = A[i][i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Eigenvalues:\n&quot;</span>);</span><br><span class="line">    <span class="built_in">PrintVector</span>(n, EigenvalueVector);</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Matrix A = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">ReadFromInput</span>(n, A, <span class="number">1</span>);</span><br><span class="line"><span class="comment">//    GenerateRandomMatrix(n, A);</span></span><br><span class="line">    <span class="built_in">PrintMatrix</span>(n, A);</span><br><span class="line">    Vector EigenvalueVector = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    <span class="built_in">JacobiMethod</span>(n, A, EigenvalueVector, <span class="number">0.000001</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Result-2"><a href="#Result-2" class="headerlink" title="Result"></a>Result</h3><h4 id="Example-1-2"><a href="#Example-1-2" class="headerlink" title="Example 1"></a>Example 1</h4><p>Raw Output:</p>
<p>$ .&#x2F;JacobiMethod.o<br>Matrix A:<br>1.0000    2.0000    3.0000    4.0000<br>2.0000    5.0000    6.0000    7.0000<br>3.0000    6.0000    8.0000    9.0000<br>4.0000    7.0000    9.0000    10.0000    </p>
<p>Iteration #1<br>Non-Diagonal Entries’ Square Sum &#x3D; 228.000000.<br>1.0000    2.0000    -0.4323    4.9813<br>2.0000    5.0000    -0.1977    9.2174<br>-0.4323    -0.1977    -0.0554    0.0000<br>4.9813    9.2174    0.0000    18.0554<br>Iteration #2<br>Non-Diagonal Entries’ Square Sum &#x3D; 58.078156.<br>1.0000    -0.5118    -0.4323    5.3433<br>-0.5118    0.2329    -0.1756    0.0000<br>-0.4323    -0.1756    -0.0554    -0.0908<br>5.3433    0.0000    -0.0908    22.8225<br>Iteration #3<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.975846.<br>-0.2381    -0.4986    -0.4006    0.0000<br>-0.4986    0.2329    -0.1756    -0.1155<br>-0.4006    -0.1756    -0.0554    -0.1861<br>0.0000    -0.1155    -0.1861    24.0606<br>Iteration #4<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.478622.<br>-0.5540    0.0000    -0.4324    -0.0618<br>0.0000    0.5488    0.0661    -0.0976<br>-0.4324    0.0661    -0.0554    -0.1861<br>-0.0618    -0.0976    -0.1861    24.0606<br>Iteration #5<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.104665.<br>-0.8038    0.0331    0.0000    -0.1466<br>0.0331    0.5488    0.0572    -0.0976<br>0.0000    0.0572    0.1944    -0.1302<br>-0.1466    -0.0976    -0.1302    24.0606<br>Iteration #6<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.061674.<br>-0.8047    0.0325    -0.0008    0.0000<br>0.0325    0.5488    0.0572    -0.0978<br>-0.0008    0.0572    0.1944    -0.1302<br>0.0000    -0.0978    -0.1302    24.0614<br>Iteration #7<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.027790.<br>-0.8047    0.0325    -0.0008    0.0000<br>0.0325    0.5488    0.0567    -0.0981<br>-0.0008    0.0567    0.1937    0.0000<br>0.0000    -0.0981    0.0000    24.0621<br>Iteration #8<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.008545.<br>-0.8047    0.0325    -0.0008    -0.0001<br>0.0325    0.5484    0.0567    0.0000<br>-0.0008    0.0567    0.1937    -0.0002<br>-0.0001    0.0000    -0.0002    24.0625<br>Iteration #9<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.002113.<br>-0.8047    0.0320    -0.0058    -0.0001<br>0.0320    0.5573    0.0000    -0.0000<br>-0.0058    0.0000    0.1849    -0.0002<br>-0.0001    -0.0000    -0.0002    24.0625<br>Iteration #10<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.000067.<br>-0.8055    0.0000    -0.0058    -0.0001<br>0.0000    0.5580    -0.0001    -0.0000<br>-0.0058    -0.0001    0.1849    -0.0002<br>-0.0001    -0.0000    -0.0002    24.0625<br>Iteration #11<br>Non-Diagonal Entries’ Square Sum &#x3D; 0.000000.<br>-0.8055    -0.0000    0.0000    -0.0001<br>-0.0000    0.5580    -0.0001    -0.0000<br>0.0000    -0.0001    0.1849    -0.0002<br>-0.0001    -0.0000    -0.0002    24.0625<br>Eigenvalues:<br>-0.8055    0.5580    0.1849    24.0625    </p>
<p>分析：</p>
<p>1. The sum of non-diagonal entries’ square shows a downward tendency。</p>
<p>2. Is the output correct？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> (* Mathicscript: 4.0.0, Mathics 4.0.0 *) </span><br><span class="line">In[1]:= A = &#123;&#123;1 - x,2,3,4&#125;,&#123;2,5 - x,6,7&#125;,&#123;3,6,8 - x,9&#125;,&#123;4,7,9,10 - x&#125;&#125; Out[1]:= &#123;&#123;1 - x, 2, 3, 4&#125;, &#123;2, 5 - x, 6, 7&#125;, &#123;3, 6, 8 - x, 9&#125;, &#123;4, 7, 9, 10 - x&#125;&#125; </span><br><span class="line">In[2]:= Solve[Det[A] == 0, x] </span><br><span class="line">Out[2]:= &#123;&#123;x -&gt; 6 + Sqrt[143 / 2 + 29 Sqrt[6]] + 5 Sqrt[6] / 2&#125;, &#123;x -&gt; 6 - 5 Sqrt[6] / 2 - Sqrt[143 / 2 - 29 Sqrt[6]]&#125;, &#123;x -&gt; 6 + Sqrt[143 / 2 - 29 Sqrt[6]] - 5 Sqrt[6] / 2&#125;, &#123;x -&gt; 6 - Sqrt[143 / 2 + 29 Sqrt[6]] + 5 Sqrt[6] / 2&#125;&#125; </span><br><span class="line">In[3]:= Solve[Det[A] == 0, x]//N </span><br><span class="line">Out[3]:= &#123;&#123;x -&gt; 24.0625&#125;, &#123;x -&gt; -0.805485&#125;, &#123;x -&gt; 0.558036&#125;, &#123;x -&gt; 0.184914&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>So the program gives a correct output.</p>
<h2 id="Lab-5-Cubic-Spline-Interpolation"><a href="#Lab-5-Cubic-Spline-Interpolation" class="headerlink" title="Lab 5 - Cubic Spline Interpolation"></a>Lab 5 - Cubic Spline Interpolation</h2><h3 id="Description-3"><a href="#Description-3" class="headerlink" title="Description"></a>Description</h3><p>Given function(or a point set), do a cubic spline interpolation. Require: at least 20 interpolation points, implement 2 boundary conditions and 3 interpolation method.</p>
<h3 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h3><h4 id="Directory-Tree"><a href="#Directory-Tree" class="headerlink" title="Directory Tree"></a>Directory Tree</h4><p>.<br>├── CubicSpline.md<br>├── Figure<br>└── src<br>    ├── Arguments.txt<br>    ├── CubicSpline.py<br>    ├── FunctionSet.py<br>    ├── Lab5.cpp<br>    ├── Lab5.o<br>    └── __pycache__<br>        └── FunctionSet.cpython-38.pyc</p>
<h4 id="C-code"><a href="#C-code" class="headerlink" title="C code"></a>C code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       Filename:  Lab5.cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    Description:  </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *        Version:  1.0</span></span><br><span class="line"><span class="comment"> *        Created:  05/11/2022 03:42:39 PM</span></span><br><span class="line"><span class="comment"> *       Revision:  none</span></span><br><span class="line"><span class="comment"> *       Compiler:  gcc</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *         Author:  CuSO4_Deposit</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SUCCESS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAILURE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INPUTPATH <span class="string">&quot;./InputData.txt&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Status;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span>* Vector;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span>** Matrix;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span> Function;</span><br><span class="line"></span><br><span class="line"><span class="function">Function <span class="title">f</span><span class="params">(<span class="type">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> e = <span class="number">2.718281828</span>; </span><br><span class="line">    <span class="keyword">return</span> (x + <span class="built_in">sin</span>(<span class="number">2</span> * x)) / (<span class="number">1</span> + <span class="built_in">pow</span>(e, -x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PrintMatrix</span><span class="params">(<span class="type">int</span> n, Matrix A)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PrintMatrix</span></span><br><span class="line"><span class="comment">     *  Description:  Print the Matrix A to the terminal. n is the Dimension of A. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\t&quot;</span>, A[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PrintVector</span><span class="params">(<span class="type">int</span> n, Vector v)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PrintVector</span></span><br><span class="line"><span class="comment">     *  Description:  Print the Vector v to the terminal(in row form). n is the Dimension of v. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\t&quot;</span>, v[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">ThomasSolve</span><span class="params">(<span class="type">int</span> n, Matrix A, Vector x, Vector b)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  ThomasSolve</span></span><br><span class="line"><span class="comment">     *  Description:  Solve Equation using Thomas Algorithm. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(j &gt;= i - <span class="number">1</span> &amp;&amp; j &lt;= i + <span class="number">1</span> )</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(A[i][j] != <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Matrix is invalid.\n A[%d][%d] = %lf.\n&quot;</span>, i, j, A[i][j]);</span><br><span class="line">                <span class="keyword">return</span> FAILURE;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    Vector u = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    Vector v = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    Vector y = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">    u[<span class="number">0</span>] = A[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    v[<span class="number">0</span>] = A[<span class="number">0</span>][<span class="number">1</span>] / u[<span class="number">0</span>];</span><br><span class="line">    y[<span class="number">0</span>] = b[<span class="number">0</span>] / u[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt; n - <span class="number">1</span>; k++)&#123;</span><br><span class="line">        u[k] = A[k][k] - A[k][k - <span class="number">1</span>] * v[k - <span class="number">1</span>];</span><br><span class="line">        v[k] = A[k][k + <span class="number">1</span>] / u[k];</span><br><span class="line">        y[k] = (b[k] - A[k][k - <span class="number">1</span>] * y[k - <span class="number">1</span>]) / u[k];</span><br><span class="line">    &#125;</span><br><span class="line">    u[n - <span class="number">1</span>] = A[n - <span class="number">1</span>][n - <span class="number">1</span>] - A[n - <span class="number">1</span>][n - <span class="number">2</span>] * v[n - <span class="number">2</span>];</span><br><span class="line">    v[n - <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    y[n - <span class="number">1</span>] = (b[n - <span class="number">1</span>] - A[n - <span class="number">1</span>][n - <span class="number">2</span>] * y[n - <span class="number">2</span>]) / u[n - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    x[n - <span class="number">1</span>] = y[n - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = n - <span class="number">2</span>; k &gt; <span class="number">-1</span>; k--)&#123;</span><br><span class="line">        x[k] = y[k] - v[k] * x[k + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">Sample</span><span class="params">(<span class="type">int</span> n, <span class="type">double</span> a, <span class="type">double</span> b, Vector SamplePoints, <span class="type">int</span> method)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  Sample</span></span><br><span class="line"><span class="comment">     *  Description:  return a vector of SamplePoints. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">switch</span>(method)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">            <span class="type">double</span> h = (b - a) / n;</span><br><span class="line">            SamplePoints[<span class="number">0</span>] = a;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n + <span class="number">1</span>; i++)</span><br><span class="line">                SamplePoints[i] = SamplePoints[i - <span class="number">1</span>] + h;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;SamplePoints:\n&quot;</span>);</span><br><span class="line">            <span class="built_in">PrintVector</span>(n + <span class="number">1</span>, SamplePoints);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">            SamplePoints[<span class="number">0</span>] = a;</span><br><span class="line">            SamplePoints[n] = b;</span><br><span class="line">            <span class="type">double</span> randomNumber;</span><br><span class="line">            <span class="type">bool</span> flag_moved;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">                randomNumber = a + (b - a) * (<span class="built_in">rand</span>() / (RAND_MAX + <span class="number">1.0</span>));</span><br><span class="line">                flag_moved = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(SamplePoints[j] &lt; randomNumber)</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    flag_moved = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> k = i - <span class="number">1</span>; k &gt;= j; k--)&#123;</span><br><span class="line">                        SamplePoints[k + <span class="number">1</span>] = SamplePoints[k];</span><br><span class="line">                    &#125;</span><br><span class="line">                    SamplePoints[j] = randomNumber;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(flag_moved == <span class="number">0</span>)</span><br><span class="line">                    SamplePoints[i] = randomNumber;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:&#123;</span><br><span class="line">            SamplePoints[<span class="number">0</span>] = a;</span><br><span class="line">            SamplePoints[n] = b;</span><br><span class="line">            <span class="type">double</span> Mid = (a + b) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(n % <span class="number">2</span>)   <span class="comment">// n - 1 is odd</span></span><br><span class="line">                SamplePoints[n / <span class="number">2</span>] = Mid;</span><br><span class="line">            <span class="type">double</span> randomNumber;</span><br><span class="line">            <span class="type">bool</span> flag_moved;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n / <span class="number">2.0</span>; i++)&#123;</span><br><span class="line">                randomNumber = a + (Mid - a) * (<span class="built_in">rand</span>() / (RAND_MAX + <span class="number">1.0</span>));</span><br><span class="line">                flag_moved = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(SamplePoints[j] &lt; randomNumber)</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    flag_moved = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="type">int</span> k = i - <span class="number">1</span>; k &gt;= j; k--)&#123;</span><br><span class="line">                        SamplePoints[k + <span class="number">1</span>] = SamplePoints[k];</span><br><span class="line">                    &#125;</span><br><span class="line">                    SamplePoints[j] = randomNumber;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(flag_moved == <span class="number">0</span>)</span><br><span class="line">                    SamplePoints[i] = randomNumber;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = n / <span class="number">2</span> + <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">                SamplePoints[i] = <span class="number">2</span> * Mid - SamplePoints[n - i];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> FAILURE;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">CubicSpline</span><span class="params">(Function f(<span class="type">double</span>), <span class="type">double</span> a, <span class="type">double</span> b, <span class="type">int</span> n, <span class="type">int</span> Boundary, <span class="type">int</span> SampleMethod)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  CubicSpline</span></span><br><span class="line"><span class="comment">     *  Description:  Use Cubic Spline Method to interpolate function f.</span></span><br><span class="line"><span class="comment">     *    Parameter:  0, ..., n is the number of interpolation points.</span></span><br><span class="line"><span class="comment">     *                  Condition = 0: Natrual Condition</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Matrix A = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    ofstream ofs;</span><br><span class="line">    ofs.<span class="built_in">open</span>(<span class="string">&quot;Arguments.txt&quot;</span>, ios::out);</span><br><span class="line">    ofs &lt;&lt; <span class="string">&quot;[&quot;</span> &lt;&lt; n &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; a &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; b &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; Boundary &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; SampleMethod &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(Boundary)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:&#123;</span><br><span class="line">            A = <span class="keyword">new</span> Vector[n - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">                A[i] = <span class="keyword">new</span> <span class="type">double</span>[n - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n - <span class="number">1</span>; j++)</span><br><span class="line">            A[i][j] = <span class="number">0</span>;</span><br><span class="line">            Vector SamplePoints = <span class="keyword">new</span> <span class="type">double</span>[n + <span class="number">1</span>];</span><br><span class="line">            <span class="built_in">Sample</span>(n, a, b, SamplePoints, SampleMethod);</span><br><span class="line">            <span class="built_in">PrintVector</span>(n + <span class="number">1</span>, SamplePoints);</span><br><span class="line">            Vector h = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            h[i] = SamplePoints[i + <span class="number">1</span>] - SamplePoints[i];</span><br><span class="line">            Vector d = <span class="keyword">new</span> <span class="type">double</span>[n - <span class="number">1</span>];</span><br><span class="line">            </span><br><span class="line">            A[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">            A[<span class="number">0</span>][<span class="number">1</span>] = h[<span class="number">1</span>] / (h[<span class="number">1</span>] + h[<span class="number">0</span>]);</span><br><span class="line">            d[<span class="number">0</span>] = <span class="number">6</span> * ((<span class="built_in">f</span>(SamplePoints[<span class="number">2</span>]) - <span class="built_in">f</span>(SamplePoints[<span class="number">1</span>])) / h[<span class="number">1</span>] - (<span class="built_in">f</span>(SamplePoints[<span class="number">1</span>]) - <span class="built_in">f</span>(SamplePoints[<span class="number">0</span>])) / h[<span class="number">0</span>]) / (h[<span class="number">1</span>] + h[<span class="number">0</span>]) - <span class="number">0</span>;</span><br><span class="line">            </span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n - <span class="number">2</span>; i++)&#123;</span><br><span class="line">                A[i][i] = <span class="number">2</span>;</span><br><span class="line">                A[i][i + <span class="number">1</span>] = h[i + <span class="number">1</span>] / (h[i + <span class="number">1</span>] + h[i]);</span><br><span class="line">                A[i][i - <span class="number">1</span>] = <span class="number">1</span> - A[i][i + <span class="number">1</span>];</span><br><span class="line">                d[i] = <span class="number">6</span> * ((<span class="built_in">f</span>(SamplePoints[i + <span class="number">2</span>]) - <span class="built_in">f</span>(SamplePoints[i + <span class="number">1</span>])) / h[i + <span class="number">1</span>] - (<span class="built_in">f</span>(SamplePoints[i + <span class="number">1</span>]) - <span class="built_in">f</span>(SamplePoints[i + <span class="number">0</span>])) / h[i + <span class="number">0</span>]) / (h[i + <span class="number">1</span>] + h[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            A[n - <span class="number">2</span>][n - <span class="number">2</span>] = <span class="number">2</span>;</span><br><span class="line">            h[n - <span class="number">1</span>] = SamplePoints[n] - SamplePoints[n - <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            A[n - <span class="number">2</span>][n - <span class="number">3</span>] = <span class="number">1</span> - h[n - <span class="number">1</span>] / (h[n - <span class="number">1</span>] + h[n - <span class="number">2</span>]);</span><br><span class="line">            d[n - <span class="number">2</span>] = <span class="number">6</span> * ((<span class="built_in">f</span>(SamplePoints[n]) - <span class="built_in">f</span>(SamplePoints[n - <span class="number">1</span>])) / h[n - <span class="number">1</span>] - (<span class="built_in">f</span>(SamplePoints[n - <span class="number">1</span>]) - <span class="built_in">f</span>(SamplePoints[n - <span class="number">2</span>])) / h[n - <span class="number">2</span>]) / (h[n - <span class="number">1</span>] + h[n - <span class="number">2</span>]);</span><br><span class="line">Vector M = <span class="keyword">new</span> <span class="type">double</span>[n - <span class="number">1</span>];</span><br><span class="line">            <span class="built_in">ThomasSolve</span>(n - <span class="number">1</span>, A, M, d);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;The Vector [x_0, ..., x_%d] is:\n[&quot;</span>, n);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.4lf, &quot;</span>, SamplePoints[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf]\n&quot;</span>, SamplePoints[n]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;The Vector [h_0, ..., h_%d] is:\n[&quot;</span>, n - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.4lf, &quot;</span>, h[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf]\n&quot;</span>, h[n - <span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;The Vector [M_0, ..., M_%d] is:\n[%.4lf, &quot;</span>, n, <span class="number">0.0</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.4lf, &quot;</span>, M[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf]\n&quot;</span>, <span class="number">0.0</span>);</span><br><span class="line"></span><br><span class="line">            ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                ofs &lt;&lt; SamplePoints[i] &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            ofs &lt;&lt; SamplePoints[n] &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">            ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">                ofs &lt;&lt; h[i] &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            ofs &lt;&lt; h[n - <span class="number">1</span>] &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">            ofs &lt;&lt; <span class="string">&quot;[0.0000, &quot;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">                ofs &lt;&lt; M[i] &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            ofs &lt;&lt; <span class="string">&quot;0.0000]\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:&#123;</span><br><span class="line">            <span class="type">double</span> m0, mn;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Please input f&#x27;(x_0), f&#x27;(x_n), seperated by space:\n&quot;</span>);</span><br><span class="line">            cin &gt;&gt; m0 &gt;&gt; mn;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            A = <span class="keyword">new</span> Vector[n + <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n + <span class="number">1</span>; i++)&#123;</span><br><span class="line">                A[i] = <span class="keyword">new</span> <span class="type">double</span>[n + <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n + <span class="number">1</span>; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; n + <span class="number">1</span>; j++)</span><br><span class="line">            A[i][j] = <span class="number">0</span>;</span><br><span class="line">            Vector SamplePoints = <span class="keyword">new</span> <span class="type">double</span>[n + <span class="number">1</span>];</span><br><span class="line">            <span class="built_in">Sample</span>(n, a, b, SamplePoints, SampleMethod);</span><br><span class="line">            Vector h = <span class="keyword">new</span> <span class="type">double</span>[n];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            h[i] = SamplePoints[i + <span class="number">1</span>] - SamplePoints[i];</span><br><span class="line">            Vector d = <span class="keyword">new</span> <span class="type">double</span>[n + <span class="number">1</span>];</span><br><span class="line">            </span><br><span class="line">            A[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">2</span>;</span><br><span class="line">            A[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">            d[<span class="number">0</span>] = <span class="number">6</span> * (((<span class="built_in">f</span>(SamplePoints[<span class="number">1</span>]) - <span class="built_in">f</span>(SamplePoints[<span class="number">0</span>])) / h[<span class="number">0</span>]) - m0) / h[<span class="number">0</span>];</span><br><span class="line">            </span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; n; i++)&#123;</span><br><span class="line">                A[i][i] = <span class="number">2</span>;</span><br><span class="line">                A[i][i + <span class="number">1</span>] = h[i] / (h[i] + h[i - <span class="number">1</span>]);</span><br><span class="line">                A[i][i - <span class="number">1</span>] = <span class="number">1</span> - A[i][i + <span class="number">1</span>];</span><br><span class="line">                d[i] = <span class="number">6</span> * ((<span class="built_in">f</span>(SamplePoints[i + <span class="number">1</span>]) - <span class="built_in">f</span>(SamplePoints[i])) / h[i] - (<span class="built_in">f</span>(SamplePoints[i]) - <span class="built_in">f</span>(SamplePoints[i - <span class="number">1</span>])) / h[i - <span class="number">1</span>]) / (h[i - <span class="number">1</span>] + h[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            A[n][n] = <span class="number">2</span>;</span><br><span class="line">            A[n][n - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">            d[n] = <span class="number">6</span> * (mn - (<span class="built_in">f</span>(SamplePoints[n]) - <span class="built_in">f</span>(SamplePoints[n - <span class="number">1</span>])) / h[n - <span class="number">1</span>]) / h[n - <span class="number">1</span>];</span><br><span class="line">Vector M = <span class="keyword">new</span> <span class="type">double</span>[n + <span class="number">1</span>];</span><br><span class="line">            <span class="built_in">ThomasSolve</span>(n + <span class="number">1</span>, A, M, d);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;The Vector [x_0, ..., x_%d] is:\n[&quot;</span>, n);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.4lf, &quot;</span>, SamplePoints[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf]\n&quot;</span>, SamplePoints[n]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;The Vector [h_0, ..., h_%d] is:\n[&quot;</span>, n - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.4lf, &quot;</span>, h[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf]\n&quot;</span>, h[n - <span class="number">1</span>]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;The Vector [M_0, ..., M_%d] is:\n[&quot;</span>, n);</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%.4lf, &quot;</span>, M[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf]\n&quot;</span>, M[n]);</span><br><span class="line"></span><br><span class="line">            ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                ofs &lt;&lt; SamplePoints[i] &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            ofs &lt;&lt; SamplePoints[n] &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">            ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)</span><br><span class="line">                ofs &lt;&lt; h[i] &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            ofs &lt;&lt; h[n - <span class="number">1</span>] &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">            ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                ofs &lt;&lt; M[i] &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">            ofs &lt;&lt; M[n] &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">    Matrix A = <span class="literal">NULL</span>;</span><br><span class="line">    Vector b = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">CubicSpline</span>(f, <span class="number">-2</span>, <span class="number">4</span>, <span class="number">25</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="python-code"><a href="#python-code" class="headerlink" title="python code"></a>python code</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">ArgumentsFile = <span class="built_in">open</span>(<span class="string">&#x27;Arguments.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">Arguments = ArgumentsFile.readlines()</span><br><span class="line"></span><br><span class="line">n, a, b, Boundary, Sample = <span class="built_in">eval</span>(Arguments[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">x = np.array(<span class="built_in">eval</span>(Arguments[<span class="number">1</span>])).astype(<span class="built_in">float</span>)</span><br><span class="line">h = np.array(<span class="built_in">eval</span>(Arguments[<span class="number">2</span>])).astype(<span class="built_in">float</span>)</span><br><span class="line">M = np.array(<span class="built_in">eval</span>(Arguments[<span class="number">3</span>])).astype(<span class="built_in">float</span>)</span><br><span class="line">ArgumentsFile.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">truef</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (x + np.sin(<span class="number">2</span> * x)) / (<span class="number">1</span> + (np.e) ** (-x))</span><br><span class="line">y = truef(x)</span><br><span class="line"></span><br><span class="line">FunctionFile = <span class="built_in">open</span>(<span class="string">&#x27;FunctionSet.py&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">FunctionFile.write(<span class="string">&quot;def func(i, x):\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line">    a0 = (-M[i + <span class="number">1</span>] * x[i] ** <span class="number">3</span> + M[i] * x[i + <span class="number">1</span>] ** <span class="number">3</span>) / (<span class="number">6</span> * h[i]) + (-M[i] * x[i + <span class="number">1</span>] + M[i + <span class="number">1</span>] * x[i]) * h[i] / <span class="number">6</span> + (x[i + <span class="number">1</span>] * y[i] - x[i] * y[i + <span class="number">1</span>]) / h[i]</span><br><span class="line">    a1 = (M[i + <span class="number">1</span>] * x[i] ** <span class="number">2</span> - M[i] * x[i + <span class="number">1</span>] ** <span class="number">2</span>) / (<span class="number">2</span> * h[i]) + (M[i] - M[i + <span class="number">1</span>]) * h[i] / <span class="number">6</span> + (y[i + <span class="number">1</span>] - y[i]) / h[i]</span><br><span class="line">    a2 = (M[i] * x[i + <span class="number">1</span>] - M[i + <span class="number">1</span>] * x[i]) / (<span class="number">2</span> * h[i])</span><br><span class="line">    a3 = (M[i + <span class="number">1</span>] - M[i]) / (<span class="number">6</span> * h[i])</span><br><span class="line">    FunctionFile.write(<span class="string">&quot;    if i == &#123;&#125;:\n&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">    <span class="comment">#FunctionFile.write(&quot;        return&quot;, a0, &quot;+ (&quot;, a1, &quot;) * x + (&quot;, a2, &quot;) * x ** 2 + (&quot;, a3, &quot;) * x ** 3&quot;)</span></span><br><span class="line">    FunctionFile.write(<span class="string">&quot;        return &quot;</span> + <span class="built_in">str</span>(a0) + <span class="string">&quot; + (&quot;</span> + <span class="built_in">str</span>(a1) + <span class="string">&quot;) * x + (&quot;</span> + <span class="built_in">str</span>(a2) + <span class="string">&quot;) * x ** 2 + (&quot;</span> + <span class="built_in">str</span>(a3) + <span class="string">&quot;) * x ** 3\n&quot;</span>)</span><br><span class="line">FunctionFile.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> FunctionSet <span class="keyword">import</span> func <span class="keyword">as</span> f</span><br><span class="line"></span><br><span class="line">plt.figure()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    xi = np.linspace(x[i], x[i + <span class="number">1</span>], <span class="number">15</span>)</span><br><span class="line">    yi = f(i, xi)</span><br><span class="line">    plt.plot(xi, yi, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">plt.scatter(x, y, color=<span class="string">&#x27;red&#x27;</span>, marker=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">xtrue = np.linspace(a ,b)</span><br><span class="line">plt.plot(xtrue, truef(xtrue), color=<span class="string">&#x27;orange&#x27;</span>, alpha=<span class="number">0.7</span>)</span><br><span class="line">name = <span class="string">&quot;Ex1Bdr&quot;</span> + <span class="built_in">str</span>(Boundary) + <span class="string">&quot;Sp&quot;</span> + <span class="built_in">str</span>(Sample)</span><br><span class="line">plt.title(name)</span><br><span class="line">plt.savefig(<span class="string">&quot;../Figure/&quot;</span> + name + <span class="string">&quot;.png&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p>In the python program, the expanded form of interpolation function is calculated by mathics&#x2F;mathematica:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">In[1]:= Collect[(Ma (b - x)^3 + Mb (x - a)^3) / (6 h) + ((b - x) ya + (x - a) yb) / h - (h / 6) ((b - x) Ma + (x - a) Mb), x]</span><br><span class="line">Out[1]:= Ma b ^ 3 / (6 h) - Ma b h / 6 - Mb a ^ 3 / (6 h) + Mb a h / 6 - a yb / h + b ya / h + x (-Ma b ^ 2 / (2 h) + Ma h / 6 + Mb a ^ 2 / (2 h) - Mb h / 6 - ya / h + yb / h) + x ^ 2 (Ma b / (2 h) - Mb a / (2 h)) + x ^ 3 (-Ma / (6 h) + Mb / (6 h))</span><br></pre></td></tr></table></figure>

<h3 id="Result-3"><a href="#Result-3" class="headerlink" title="Result"></a>Result</h3><p>$f(x) &#x3D; \dfrac{x}{x ^ 2 + x + 1}$</p>
<p>$f(x) &#x3D; \dfrac{x + \sin {2x}}{1 + e^{-x}}$</p>
<h2 id="Lab-6-FFT-amp-IFFT"><a href="#Lab-6-FFT-amp-IFFT" class="headerlink" title="Lab 6 - FFT &amp; IFFT"></a>Lab 6 - FFT &amp; IFFT</h2><h3 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       Filename:  FFT.cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    Description:  Fast Fourier Transform Algorithm</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *        Version:  1.0</span></span><br><span class="line"><span class="comment"> *        Created:  05/29/2022 02:17:10 UTC</span></span><br><span class="line"><span class="comment"> *       Revision:  none</span></span><br><span class="line"><span class="comment"> *       Compiler:  gcc</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *         Author:  CuSO4_Deposit</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;complex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SUCCESS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAILURE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PI 3.1415926535</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> E 2.718281828</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> complex&lt;<span class="type">double</span>&gt;<span class="built_in">I</span>(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Status;</span><br><span class="line"><span class="keyword">typedef</span> vector&lt;complex&lt;<span class="type">double</span>&gt;&gt; Vector;</span><br><span class="line"><span class="keyword">typedef</span> complex&lt;<span class="type">double</span>&gt; Function; </span><br><span class="line"></span><br><span class="line"><span class="function">Function <span class="title">F</span><span class="params">(<span class="type">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.7</span> * <span class="built_in">sin</span>(<span class="number">4</span> * PI * x) + <span class="built_in">sin</span>(<span class="number">10</span> * PI * x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PrintVector</span><span class="params">(Vector v, <span class="type">int</span> mode)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PrintVector</span></span><br><span class="line"><span class="comment">     *  Description:  Print the Vector v to the terminal(in row form). n is the Dimension of v. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> n = v.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">switch</span>(mode)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:     </span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            cout&lt;&lt; v[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            cout&lt;&lt; v[i].<span class="built_in">real</span>() &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            cout&lt;&lt; v[i].<span class="built_in">imag</span>() &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;Invalid mode input.&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Vector <span class="title">Sample</span><span class="params">(Function f(<span class="type">double</span>), <span class="type">int</span> Number)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  Sample</span></span><br><span class="line"><span class="comment">     *  Description:  Sample Number points on interval[0, 1]</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">if</span>(Number &amp; (Number - <span class="number">1</span>))&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Number must be the power of 2.&quot;</span> &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    Vector fvector;</span><br><span class="line">    <span class="type">double</span> stepsize = <span class="number">1.0</span> / Number;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; Number; i++)&#123;</span><br><span class="line">        fvector.<span class="built_in">push_back</span>(<span class="built_in">f</span>(i * stepsize));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fvector;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Vector <span class="title">AddError</span><span class="params">(<span class="type">double</span> size, Vector v)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  AddError </span></span><br><span class="line"><span class="comment">     *  Description:  Add a error of [0, size) to v. </span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> n = v.<span class="built_in">size</span>();</span><br><span class="line">    cout &lt;&lt; n;</span><br><span class="line">    <span class="function">Vector <span class="title">result</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        result[i] = v[i] + size * (<span class="built_in">rand</span>() / (RAND_MAX + <span class="number">1.0</span>));</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Vector <span class="title">FFT</span><span class="params">(<span class="type">const</span> Vector&amp; f)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = f.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    complex&lt;<span class="type">double</span>&gt;wn;</span><br><span class="line">    wn = <span class="built_in">pow</span>(E, - I * <span class="number">2.0</span> * PI / (<span class="type">double</span>)n);</span><br><span class="line">    complex&lt;<span class="type">double</span>&gt;<span class="built_in">w</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    Vector f0, f1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n / <span class="number">2</span>; i++)&#123;</span><br><span class="line">        f0.<span class="built_in">push_back</span>(f[<span class="number">2</span> * i]);</span><br><span class="line">        f1.<span class="built_in">push_back</span>(f[<span class="number">2</span> * i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    Vector g0, g1;</span><br><span class="line">    g0 = <span class="built_in">FFT</span>(f0);</span><br><span class="line">    g1 = <span class="built_in">FFT</span>(f1);</span><br><span class="line">    <span class="function">Vector <span class="title">g</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n / <span class="number">2</span>; k++)&#123;</span><br><span class="line">        g[k] = (g0[k] + w * g1[k]) / <span class="number">2.0</span>;</span><br><span class="line">        g[k + n / <span class="number">2</span>] = (g0[k] - w * g1[k]) / <span class="number">2.0</span>;</span><br><span class="line">        w = w * wn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> g;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Vector <span class="title">IFFT</span><span class="params">(<span class="type">const</span> Vector&amp; f)</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n = f.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    complex&lt;<span class="type">double</span>&gt;wn;</span><br><span class="line">    wn = <span class="built_in">pow</span>(E, I * <span class="number">2.0</span> * PI / (<span class="type">double</span>)n);</span><br><span class="line">    complex&lt;<span class="type">double</span>&gt;<span class="built_in">w</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    Vector f0, f1;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n / <span class="number">2</span>; i++)&#123;</span><br><span class="line">        f0.<span class="built_in">push_back</span>(f[<span class="number">2</span> * i]);</span><br><span class="line">        f1.<span class="built_in">push_back</span>(f[<span class="number">2</span> * i + <span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    Vector g0, g1;</span><br><span class="line">    g0 = <span class="built_in">IFFT</span>(f0);</span><br><span class="line">    g1 = <span class="built_in">IFFT</span>(f1);</span><br><span class="line">    <span class="function">Vector <span class="title">g</span><span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; n / <span class="number">2</span>; k++)&#123;</span><br><span class="line">        g[k] = (g0[k] + w * g1[k]);</span><br><span class="line">        g[k + n / <span class="number">2</span>] = (g0[k] - w * g1[k]);</span><br><span class="line">        w = w * wn;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> g;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PlotTime</span><span class="params">(Function F(<span class="type">double</span>), <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PlotTime</span></span><br><span class="line"><span class="comment">     *  Description:  Output the code to plot F in python.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ofstream ofs;</span><br><span class="line">    ofs.<span class="built_in">open</span>(<span class="string">&quot;TimeParam.txt&quot;</span>, ios::out);</span><br><span class="line">    ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        ofs &lt;&lt; (<span class="type">double</span>)i / n &lt;&lt; <span class="string">&quot;, &quot;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    ofs &lt;&lt; (<span class="type">double</span>)(n - <span class="number">1</span>) / n &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        ofs &lt;&lt; <span class="built_in">F</span>((<span class="type">double</span>)i / n).<span class="built_in">real</span>() &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ofs &lt;&lt; <span class="built_in">F</span>((<span class="type">double</span>)(n - <span class="number">1</span>) / n).<span class="built_in">real</span>() &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PlotFrequency</span><span class="params">(Vector g, <span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PlotFrequency</span></span><br><span class="line"><span class="comment">     *  Description:  Visualize Fourier Transformation.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ofstream ofs;</span><br><span class="line">    ofs.<span class="built_in">open</span>(<span class="string">&quot;FrequencyParam.txt&quot;</span>, ios::out);</span><br><span class="line">    ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        ofs &lt;&lt; i &lt;&lt; <span class="string">&quot;, &quot;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    ofs &lt;&lt; n - <span class="number">1</span> &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        ofs &lt;&lt; <span class="built_in">sqrt</span>(g[i].<span class="built_in">real</span>() * g[i].<span class="built_in">real</span>() + g[i].<span class="built_in">imag</span>() * g[i].<span class="built_in">imag</span>()) &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ofs &lt;&lt; <span class="built_in">sqrt</span>(g[n - <span class="number">1</span>].<span class="built_in">real</span>() * g[n - <span class="number">1</span>].<span class="built_in">real</span>() + g[n - <span class="number">1</span>].<span class="built_in">imag</span>() * g[n - <span class="number">1</span>].<span class="built_in">imag</span>()) &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">PlotTimeI</span><span class="params">(Vector g, <span class="type">int</span> n, <span class="type">int</span> mode)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  PlotFrequency</span></span><br><span class="line"><span class="comment">     *  Description:  Visualize Fourier Transformation.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    ofstream ofs;</span><br><span class="line">    <span class="keyword">if</span>(mode)</span><br><span class="line">        ofs.<span class="built_in">open</span>(<span class="string">&quot;ITimeParam1.txt&quot;</span>, ios::out);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        ofs.<span class="built_in">open</span>(<span class="string">&quot;ITimeParam0.txt&quot;</span>, ios::out);</span><br><span class="line">    ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        ofs &lt;&lt; i &lt;&lt; <span class="string">&quot;, &quot;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    ofs &lt;&lt; n - <span class="number">1</span> &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    ofs &lt;&lt; <span class="string">&quot;[&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n - <span class="number">1</span>; i++)&#123;</span><br><span class="line">        ofs &lt;&lt; g[i].<span class="built_in">real</span>() &lt;&lt; <span class="string">&quot;, &quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ofs &lt;&lt; g[n - <span class="number">1</span>].<span class="built_in">real</span>() &lt;&lt; <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="number">0</span>));</span><br><span class="line">    Vector tempvector = <span class="built_in">Sample</span>(F, <span class="number">64</span>);</span><br><span class="line">    Vector fvector = <span class="built_in">AddError</span>(<span class="number">0.3</span>, tempvector);</span><br><span class="line">    Vector gvector = <span class="built_in">FFT</span>(fvector);</span><br><span class="line">    <span class="built_in">PrintVector</span>(gvector, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">PrintVector</span>(gvector, <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">PlotTime</span>(F, <span class="number">64</span>);</span><br><span class="line">    <span class="built_in">PlotFrequency</span>(gvector, <span class="number">64</span>);</span><br><span class="line">    Vector igvector = <span class="built_in">IFFT</span>(gvector);</span><br><span class="line">    <span class="built_in">PlotTimeI</span>(igvector, <span class="number">64</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> n = gvector.<span class="built_in">size</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">if</span>(i &gt; n / <span class="number">8</span> &amp;&amp; i &lt; <span class="number">3</span> * n / <span class="number">8</span>)</span><br><span class="line">            gvector[i] = (<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    igvector = <span class="built_in">IFFT</span>(gvector);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">PlotTimeI</span>(igvector, <span class="number">64</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line">ArgumentsFile = open(&quot;./ITimeParam1.txt&quot;, &#x27;r&#x27;)</span><br><span class="line">Arguments = ArgumentsFile.readlines()</span><br><span class="line"></span><br><span class="line">x = np.array(eval(Arguments[0])).astype(float)</span><br><span class="line">y = np.array(eval(Arguments[1])).astype(float)</span><br><span class="line"></span><br><span class="line">plt.figure()</span><br><span class="line">plt.plot(x, y)</span><br><span class="line">name = &quot;Ex2ITime1n7&quot;</span><br><span class="line">plt.title(name)</span><br><span class="line">plt.savefig(&quot;../figure/&quot; + name + &quot;.png&quot;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<h2 id="Lab7-Romberg-Integral"><a href="#Lab7-Romberg-Integral" class="headerlink" title="Lab7 - Romberg Integral"></a>Lab7 - Romberg Integral</h2><h3 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *       Filename:  Romberg.cpp</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *    Description:  Implement Romberg Integral</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *        Version:  1.0</span></span><br><span class="line"><span class="comment"> *        Created:  06/14/2022 10:49:02 PM</span></span><br><span class="line"><span class="comment"> *       Revision:  none</span></span><br><span class="line"><span class="comment"> *       Compiler:  gcc</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> *         Author:  CuSO4_Deposit</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * =====================================================================================</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SUCCESS 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> FAILURE 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> PI 3.1415926535</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> E 2.718281828</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int</span> Status;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">double</span> Function;</span><br><span class="line"></span><br><span class="line"><span class="function">Function <span class="title">f</span><span class="params">(<span class="type">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="comment">//return log(x);</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(<span class="number">2</span> - <span class="built_in">sin</span>(x) * <span class="built_in">sin</span>(x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Status <span class="title">Romberg</span><span class="params">(Function f(<span class="type">double</span> x), <span class="type">double</span> a, <span class="type">double</span> b, <span class="type">double</span>&amp; result, <span class="type">double</span> AccControler, <span class="type">int</span> MaxLoopNumber, <span class="type">int</span> verbose)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">     * ===  FUNCTION  ======================================================================</span></span><br><span class="line"><span class="comment">     *         Name:  Romberg</span></span><br><span class="line"><span class="comment">     *  Description:  return the Romberg integral of f on [a, b] through &lt;result&gt;,</span></span><br><span class="line"><span class="comment">     *                  exit when loop &lt;MaxLoopNumber&gt; times or error &lt; AccControler.</span></span><br><span class="line"><span class="comment">     * =====================================================================================</span></span><br><span class="line"><span class="comment">     */</span> </span><br><span class="line">    <span class="type">double</span>* RombergArray1 = <span class="keyword">new</span> <span class="type">double</span>[MaxLoopNumber + <span class="number">1</span>];</span><br><span class="line">    <span class="type">double</span>* RombergArray2 = <span class="keyword">new</span> <span class="type">double</span>[MaxLoopNumber + <span class="number">1</span>];</span><br><span class="line">    <span class="type">double</span> h = b - a;</span><br><span class="line">    RombergArray1[<span class="number">0</span>] = (<span class="built_in">f</span>(a) + <span class="built_in">f</span>(b)) * h / <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(verbose)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lf\n&quot;</span>, RombergArray1[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">1</span>; k &lt; MaxLoopNumber; k++)&#123;</span><br><span class="line">        <span class="type">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="type">double</span> hk = h / <span class="built_in">pow</span>(<span class="number">2</span>, k);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt; <span class="built_in">pow</span>(<span class="number">2</span>, k - <span class="number">1</span>) + <span class="number">1</span>; i++)</span><br><span class="line">            sum += <span class="built_in">f</span>(a + (<span class="number">2</span> * i - <span class="number">1</span>) * hk);</span><br><span class="line">        RombergArray2[<span class="number">0</span>] = (RombergArray1[<span class="number">0</span>] + <span class="number">2</span> * hk * sum) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt; k + <span class="number">1</span>; j++)&#123;</span><br><span class="line">            RombergArray2[j] = RombergArray2[j - <span class="number">1</span>] + (RombergArray2[j - <span class="number">1</span>] - RombergArray1[j - <span class="number">1</span>]) / (<span class="built_in">pow</span>(<span class="number">4</span>, j));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(RombergArray2[k] - RombergArray1[k - <span class="number">1</span>]) &lt; AccControler)&#123;</span><br><span class="line">            result = RombergArray2[k];</span><br><span class="line">            <span class="keyword">return</span> SUCCESS;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(verbose)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; k + <span class="number">1</span>; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lf\t&quot;</span>, RombergArray2[i]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; k + <span class="number">1</span>; j++)</span><br><span class="line">            RombergArray1[j] = RombergArray2[j];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    result = RombergArray2[MaxLoopNumber];</span><br><span class="line">    <span class="keyword">return</span> SUCCESS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">double</span> result;</span><br><span class="line">    <span class="comment">//Romberg(f, 1, 2, result, 0.000001, 20, 1);</span></span><br><span class="line">    <span class="built_in">Romberg</span>(f, -PI / <span class="number">6.0</span>, <span class="number">3.0</span> * PI / <span class="number">4</span>, result, <span class="number">0.000001</span>, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

  </div>
</article>


    <div class="blog-post-comments">
        <div id="utterances_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>


        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/friends/">Friends</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Index"><span class="toc-number">1.</span> <span class="toc-text">Index</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab2-Direct-Methods-for-Solving-Linear-Equations"><span class="toc-number">2.</span> <span class="toc-text">Lab2 - Direct Methods for Solving Linear Equations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description"><span class="toc-number">2.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implement"><span class="toc-number">2.2.</span> <span class="toc-text">Implement</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Predefinition-and-Useful-functions"><span class="toc-number">2.2.1.</span> <span class="toc-text">Predefinition and Useful functions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Input"><span class="toc-number">2.2.2.</span> <span class="toc-text">Input</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Solving-Triangular-Form-Equations"><span class="toc-number">2.2.3.</span> <span class="toc-text">Solving Triangular-Form Equations</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Gaussian-Method"><span class="toc-number">2.2.4.</span> <span class="toc-text">Gaussian Method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LU-Decomposition-and-Doolittle-Method"><span class="toc-number">2.2.5.</span> <span class="toc-text">LU Decomposition and Doolittle Method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Calculate-Error"><span class="toc-number">2.2.6.</span> <span class="toc-text">Calculate Error</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Main-Function-Calling-the-Functions-implemented-above"><span class="toc-number">2.2.7.</span> <span class="toc-text">Main Function - Calling the Functions implemented above</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result"><span class="toc-number">2.3.</span> <span class="toc-text">Result</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-1"><span class="toc-number">2.3.1.</span> <span class="toc-text">Example 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">Example 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-number">2.4.</span> <span class="toc-text">Summary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab3-Inverse-Power-Method-to-Solve-Eigenvalue"><span class="toc-number">3.</span> <span class="toc-text">Lab3 - Inverse Power Method to Solve Eigenvalue</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-1"><span class="toc-number">3.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code"><span class="toc-number">3.2.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result-1"><span class="toc-number">3.3.</span> <span class="toc-text">Result</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-1-1"><span class="toc-number">3.3.1.</span> <span class="toc-text">Example 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-2-1"><span class="toc-number">3.3.2.</span> <span class="toc-text">Example 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Analysis"><span class="toc-number">3.4.</span> <span class="toc-text">Analysis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab4-Jacobi-Method-to-Solve-Eigenvalue"><span class="toc-number">4.</span> <span class="toc-text">Lab4 - Jacobi Method to Solve Eigenvalue</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-2"><span class="toc-number">4.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-1"><span class="toc-number">4.2.</span> <span class="toc-text">Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result-2"><span class="toc-number">4.3.</span> <span class="toc-text">Result</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Example-1-2"><span class="toc-number">4.3.1.</span> <span class="toc-text">Example 1</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab-5-Cubic-Spline-Interpolation"><span class="toc-number">5.</span> <span class="toc-text">Lab 5 - Cubic Spline Interpolation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Description-3"><span class="toc-number">5.1.</span> <span class="toc-text">Description</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-2"><span class="toc-number">5.2.</span> <span class="toc-text">Code</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Directory-Tree"><span class="toc-number">5.2.1.</span> <span class="toc-text">Directory Tree</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#C-code"><span class="toc-number">5.2.2.</span> <span class="toc-text">C code</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python-code"><span class="toc-number">5.2.3.</span> <span class="toc-text">python code</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Result-3"><span class="toc-number">5.3.</span> <span class="toc-text">Result</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab-6-FFT-amp-IFFT"><span class="toc-number">6.</span> <span class="toc-text">Lab 6 - FFT &amp; IFFT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-3"><span class="toc-number">6.1.</span> <span class="toc-text">Code</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lab7-Romberg-Integral"><span class="toc-number">7.</span> <span class="toc-text">Lab7 - Romberg Integral</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Code-4"><span class="toc-number">7.1.</span> <span class="toc-text">Code</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&text=Numerical Analysis - Lab"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&is_video=false&description=Numerical Analysis - Lab"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Numerical Analysis - Lab&body=Check out this article: https://blog.depoze.xyz/2022/03/numeral-analysis-lab/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&title=Numerical Analysis - Lab"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&name=Numerical Analysis - Lab&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://blog.depoze.xyz/2022/03/numeral-analysis-lab/&t=Numerical Analysis - Lab"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
	Contents are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">CC-BY-SA 4.0</a>.
	<br>
    Copyright &copy;
    
    
    2021-2023
    CuSO4_Deposit
  </div>
  <div class="footer-right">
	Theme <a target="_blank" rel="noopener" href="https://github.com/probberechts/hexo-theme-cactus">Cactus</a>. Powered by Github Pages.
  	<br>
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Articles</a></li><!--
     --><!--
       --><li><a href="/friends/">Friends</a></li><!--
     --><!--
       --><li><a href="/atom.xml">RSS</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

    <script type="text/javascript">
      var utterances_repo = 'CuSO4Deposit/CuSO4Deposit.github.io';
      var utterances_issue_term = 'url';
      var utterances_label = 'Comment';
      var utterances_theme = 'github-dark';

      (function(){
          var script = document.createElement('script');

          script.src = 'https://utteranc.es/client.js';
          script.setAttribute('repo', utterances_repo);
          script.setAttribute('issue-term', 'pathname');
          script.setAttribute('label', utterances_label);
          script.setAttribute('theme', utterances_theme);
          script.setAttribute('crossorigin', 'anonymous');
          script.async = true;
          (document.getElementById('utterances_thread')).appendChild(script);
      }());
  </script>

</body>
</html>
